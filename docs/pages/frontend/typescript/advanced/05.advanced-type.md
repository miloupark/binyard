# Advanced Types

고급 타입이란 기본 타입을 확장하여 복잡한 타입 관계를 표현할 수 있게 해준다.

- 조건부 타입 (Conditional Type)
- keyof 연산자 타입
- 매핑 타입 (Mapped Type)

<br>

## 1. 조건부 타입 (Conditional Type)

```ts
T extends U ? X : Y;
```

- 타입 수준의 삼항 연산자처럼 동작한다.
- 특정 타입이 다른 타입에 할당 가능한지를 조건으로 판단한다.
- 복잡한 제네릭 타입의 분기 처리를 간결하게 표현할 수 있다.

<br>

```ts
type IsNumber<T> = T extends number ? "Yes" : "No";

type Result1 = IsNumber<number>; // Yes
type Result2 = IsNumber<string>; // No
```

<br>

```ts
type JsonOrText<T extends "json" | "text"> = T extends "json" ? object : string;

type JsonResponse = JsonOrText<"json">; // object
type TextResponse = JsonOrText<"text">; // string
```

- 조건부 타입은 `API 응답 타입 분기`, `제네릭 타입 변환`, `infer` 키워드와 함께 타입 추론 시 자주 쓰인다.

<br>

## 2. keyof 연산자 타입

객체 타입의 모든 키를 문자열 리터럴 유니언으로 추출한다.

```ts
type MyObject = {
  a: number;
  b: string;
  c: boolean;
};

// MyObject 키를 union 타입으로 추출
type Keys = keyof MyObject; // "a" | "b" | "c"
```

- 런타임의 `Object.keys()`와 달리 타입 수준에서 작동한다.
- 제네릭 제약`(K extends keyof T)`과 함께 많이 사용된다.

<br>

```ts
// 안전한 속성 접근 함수
function getProp<T, K extends keyof T>(obj: T, key: K): T[K] {
  return obj[key];
}

const obj = { x: 10, y: 20, z: 15 };
const value = getProp(obj, "y"); // 20
```

- `keyof`는 매핑 타입의 기반이 되며, 객체의 키를 반복적으로 순회하거나 제약할 때 매우 유용하다.

<br>

## 3. 매핑 타입 (Mapped Type)

기존 타입을 기반으로 새로운 타입을 변형해 만드는 문법  
키를 순회(for-in과 비슷)하며 속성 타입을 수정할 수 있다.

```ts
type Mapped<T> = {
  [P in keyof T]: T[P];
};

type OptionalType<T> = {
  [P in keyof T]?: T[P];
};

type ReadonlyType<T> = {
  readonly [P in keyof T]: T[P];
};
```

- 단순히 동일한 타입을 복사하는 형태이지만,  
  속성의 `선택적(Optional)`, `읽기 전용(Readonly)` 변환 등에도 활용할 수 있다.

<br>

```ts
type UserType = {
  id: number;
  name: string;
  age: number;
  email: string;
};

// 모든 속성이 optional
type OptionalUserType = OptionalType<UserType>;
// { id?: number; name?: string; age?: number; email?: string; }

// 모든 속성이 readonly
type ReadonlyUserType = ReadonlyType<UserType>;
// { readonly id: number; readonly name: string; ... }
```

- 매핑 타입은 `Partial<T>`, `Readonly<T>`, `Pick<T>`, `Record<K, T>`
  같은 TS 내장 유틸리티 타입의 핵심 원리이기도 하다.

<br>

| 구분            | 설명                         | 주요 키워드                  | 대표 사용처                                 |
| --------------- | ---------------------------- | ---------------------------- | ------------------------------------------- |
| **조건부 타입** | 타입 간 조건 분기            | `extends`, `? :`             | 제네릭 타입 변환                            |
| **keyof**       | 객체의 key를 유니언으로 추출 | `keyof`, `K extends keyof T` | 안전한 속성 접근, 제약 조건                 |
| **매핑 타입**   | 기존 타입을 순회·변형        | `[P in keyof T]`             | `Partial`, `Readonly` 등 유틸리티 타입 구현 |
